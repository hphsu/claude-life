"""
å§“åå­¸è¨ˆç®—æ¨¡çµ„ (Chinese Name Analysis Calculator)
åŸºæ–¼äº”æ ¼å‰–è±¡æ³•å’Œå§“åç­†ç•«æ•¸ç†
"""

from typing import Dict, List, Any


class NameAnalysisCalculator:
    """å§“åå­¸è¨ˆç®—å™¨"""

    # å§“åå­¸æ•¸ç†å‰å‡¶è¡¨ (1-81)
    SHULI_MEANINGS = {
        1: {"luck": "å¤§å‰", "meaning": "å¤©åœ°é–‹æ³°è¬ç‰©ç”Ÿ", "desc": "å¤©åœ°é–‹æ³°ï¼Œè¬ç‰©æˆå½¢ï¼Œç¹æ¦®æ˜Œéš†ï¼Œæœ‰é ˜å°åŠ›"},
        2: {"luck": "å‡¶", "meaning": "æ··æ²Œæœªå®šçµ‚æ­¸åˆ†", "desc": "æ··æ²Œæœªå®šï¼Œåˆ†é›¢ç ´æ•—ï¼Œäº‹æ¥­ä¸é †ï¼Œéœ€è¦ä¾é ä»–äºº"},
        3: {"luck": "å¤§å‰", "meaning": "ç«‹èº«å‡ºä¸–æ¬Šå¨é‡", "desc": "æ™ºæ…§ä»å‹‡ï¼Œæ„å¿—å …å›ºï¼Œå»ºç«‹äº‹æ¥­ï¼Œååˆ©é›™æ”¶"},
        4: {"luck": "å‡¶", "meaning": "ç ´æ•—å‡¶è®Šè¬äº‹ä¼‘", "desc": "æ—¥è¢«é›²é®ï¼Œè‹¦é›£æŠ˜ç£¨ï¼Œéæœ‰æ¯…åŠ›ï¼Œé›£æœ›æˆåŠŸ"},
        5: {"luck": "å¤§å‰", "meaning": "ç¦ç¥¿é•·å£½é™°é™½å’Œ", "desc": "é™°é™½å’Œåˆï¼Œç²¾ç¥æ„‰å¿«ï¼Œæ¦®è­½é”åˆ©ï¼Œä¸€é–€èˆˆéš†"},
        6: {"luck": "å¤§å‰", "meaning": "å®‰ç©©é¤˜æ…¶ç¦ç¥¿é–‹", "desc": "å¤©å¾·åœ°ç¥¥ï¼Œç¦ç¥¿è±åšï¼Œå¹³å®‰å¹¸ç¦ï¼Œååˆ©é›™æ”¶"},
        7: {"luck": "å‰", "meaning": "å‰›æ¯…æœæ•¢ç¨ç«‹æ¬Š", "desc": "ç²¾åŠ›æ—ºç››ï¼Œé ­è…¦æ˜æ•ï¼Œå…‹æœè¬é›£ï¼Œå¿…ç²æˆåŠŸ"},
        8: {"luck": "å¤§å‰", "meaning": "å¿—å‰›æ„å¥å‹¤å‹‰èˆˆ", "desc": "æ„å¿—å¦‚éµï¼Œå¯Œæ–¼é€²å–ï¼Œçªç ´è¬é›£ï¼Œå¿…ç²æˆåŠŸ"},
        9: {"luck": "å‡¶", "meaning": "èˆˆç›¡å‡¶å§‹å›°è‹¦å¤š", "desc": "é›–æœ‰æ‰èƒ½ï¼Œæœ‰å¿—é›£ä¼¸ï¼Œç¼ºä¹é ˜å°æ‰èƒ½ï¼Œé›£æˆå¤§æ¥­"},
        10: {"luck": "å‡¶", "meaning": "è¬ç‰©çµ‚å±€å……æ»¿æ", "desc": "é»‘æš—ä¹‹å¢ƒï¼Œç©ºè™›ç„¡ç‰©ï¼Œå‰é€”ä¸æ˜ï¼Œç½é›£é‡é‡"},
        11: {"luck": "å¤§å‰", "meaning": "è‰æœ¨é€¢æ˜¥æ¯æœ¨é€¢", "desc": "é™°é™½å¾©æ–°ï¼Œå®¶é‹éš†æ˜Œï¼Œè¬äº‹å¦‚æ„ï¼Œäº«å¤©è³¦å¹¸é‹"},
        12: {"luck": "å‡¶", "meaning": "è–„å¼±ç„¡åŠ›å­¤ç«‹ç„¡", "desc": "å®¶åº­ç·£è–„ï¼Œå­¤ç¨é­é›£ï¼Œè¬€äº‹ä¸é”ï¼Œæ‚²æ…˜ä¸å ª"},
        13: {"luck": "å¤§å‰", "meaning": "æ™ºç•¥è¶…ç¾¤åšå­¸å¤š", "desc": "å¤©è³¦å¹¸é‹ï¼Œèƒ½å¾—äººæœ›ï¼Œå–„ç”¨æ™ºæ…§ï¼Œå¿…ç²æˆåŠŸ"},
        14: {"luck": "å‡¶", "meaning": "æ·ªè½å¤©æ¶¯å¤±æ„ç…©", "desc": "å®¶åº­ç·£è–„ï¼Œå­¤ç¨å—è‹¦ï¼Œè¬€äº‹ä¸æˆï¼Œå‰é€”æš—æ·¡"},
        15: {"luck": "å¤§å‰", "meaning": "ç¦å£½åœ“æ»¿è²¡å¸›è±", "desc": "ç¦å£½åœ“æ»¿ï¼Œå¯Œè²´æ¦®è­½ï¼Œæ¶µé¤Šé›…é‡ï¼Œå¾·é«˜æœ›é‡"},
        16: {"luck": "å¤§å‰", "meaning": "è²´äººå¤šåŠ©æˆå¤§æ¥­", "desc": "åå‡¶åŒ–å‰ï¼Œå¾—è²´äººåŠ©ï¼Œå¯æˆå¤§æ¥­ï¼Œå¯Œè²´æ¦®é”"},
        17: {"luck": "å¤§å‰", "meaning": "çªç ´è¬é›£æ¬Šå¨é«˜", "desc": "æ¬Šå¨å‰›å¼·ï¼Œæ„å¿—å …å®šï¼Œçªç ´è¬é›£ï¼Œå¿…ç²æˆåŠŸ"},
        18: {"luck": "å¤§å‰", "meaning": "æœ‰å¿—ç«ŸæˆåŠŸåå°±", "desc": "ç¶“å•†åšäº‹ï¼Œé †åˆ©æ˜Œéš†ï¼Œå¦‚èƒ½æ…å§‹ï¼Œç™¾äº‹äº¨é€š"},
        21: {"luck": "å¤§å‰", "meaning": "æ˜æœˆä¸­å¤©å…‰è¼ç…§", "desc": "å…‰é¢¨éœ½æœˆï¼Œè¬ç‰©ç¢ºç«‹ï¼Œå®˜é‹äº¨é€šï¼Œå¤§æååˆ©"},
        23: {"luck": "å¤§å‰", "meaning": "æ—­æ—¥æ±æ˜‡ç™¼è‚²èŒ‚", "desc": "å‰å¤§æ˜Œéš†ï¼Œå¨éœ‡å››æ–¹ï¼Œååˆ©ä¿±å…¨ï¼Œé ˜å°çœ¾äºº"},
        24: {"luck": "å¤§å‰", "meaning": "éŒ¦ç¹¡å‰ç¨‹é è‡ªç«‹", "desc": "å®¶é–€é¤˜æ…¶ï¼Œé‡‘éŒ¢è±ç›ˆï¼Œç™½æ‰‹æˆå®¶ï¼Œè²¡æºå»£é€²"},
        25: {"luck": "å¤§å‰", "meaning": "è³‡æ€§è‹±æ•å‰›æ¯…æœ", "desc": "è³‡æ€§è‹±æ•ï¼Œæœ‰å¥‡ç‰¹æ‰èƒ½ï¼Œå…‹æœå‚²æ…¢ï¼ŒæˆåŠŸå¯æœŸ"},
        29: {"luck": "å¤§å‰", "meaning": "æ™ºè¬€å…¼å‚™æˆå¤§æ¥­", "desc": "æ™ºè¬€å„ªç§€ï¼Œè²¡åŠ›æ­¸é›†ï¼Œåèæµ·å…§ï¼Œæˆå°±å¤§æ¥­"},
        31: {"luck": "å¤§å‰", "meaning": "æ™ºä»å‹‡å…¨å¾—äººæœ›", "desc": "æ™ºä»å‹‡ä¿±å‚™ï¼Œæ„å¿—å …å›ºï¼Œåƒè¼‰ä¸€é‡ï¼Œåšå¾—ååˆ©"},
        32: {"luck": "å¤§å‰", "meaning": "åƒ¥å€–å¤šèƒ½æ„å¤–æƒ ", "desc": "åƒ¥å€–å¤šæœ›ï¼Œè²´äººå¤šåŠ©ï¼Œè²¡æºå»£é€²ï¼Œç¹æ¦®è‡³ä¸Š"},
        33: {"luck": "å¤§å‰", "meaning": "å®¶é–€éš†æ˜Œæ‰å¾·é–‹", "desc": "å®¶é–€éš†æ˜Œï¼Œæ‰å¾·é–‹å±•ï¼Œæ™ºè¬€å¥‡ç•¥ï¼Œæˆå°±å¤§æ¥­"},
        35: {"luck": "å¤§å‰", "meaning": "æº«å’Œå¹³éœå„ªé›…é–‹", "desc": "æº«å’Œå¹³éœï¼Œæ™ºé”é€šæš¢ï¼Œæ–‡æ˜ŒæŠ€è—ï¼Œå¥åŠŸæ´‹æ´‹"},
        37: {"luck": "å¤§å‰", "meaning": "æ¬Šå¨é¡¯é”çŒ›è™å‡º", "desc": "ç¨ç«‹æ¬Šå¨ï¼Œå¿ èª å¯å˜‰ï¼Œèƒ½æˆå¤§æ¥­ï¼ŒåŠŸåé¡¯é”"},
        39: {"luck": "å¤§å‰", "meaning": "å¯Œè²´æ¦®è¯æ¬Šå¨é‡", "desc": "å¯Œè²´æ¦®è¯ï¼Œè²¡å¸›è±ç›ˆï¼Œæš—è—éšªè±¡ï¼Œå¾·æ¾¤å››æ–¹"},
        41: {"luck": "å¤§å‰", "meaning": "å¾·æœ›é«˜å¤§äº‹äº‹æˆ", "desc": "å¾·é«˜æœ›é‡ï¼Œæœ‰å¯¦åŠ›ï¼Œæ™ºè¬€å…¼å‚™ï¼Œå¯æˆå¤§æ¥­"},
        45: {"luck": "å¤§å‰", "meaning": "é †é¢¨æšå¸†æ–°äº‹æ¥­", "desc": "é †é¢¨æšå¸†ï¼Œæœ‰æ™ºè¬€ï¼Œç¶“ç·¯äº‹æ¥­ï¼Œå¿…ç²æˆåŠŸ"},
        47: {"luck": "å¤§å‰", "meaning": "æœ‰è²´äººåŠ©æˆå¤§æ¥­", "desc": "è²´äººç›¸åŠ©ï¼Œå¯æˆå¤§æ¥­ï¼Œé›–é‡å›°é›£ï¼Œæµ®æ²‰ä¸å®š"},
        48: {"luck": "å¤§å‰", "meaning": "æ™ºè¬€å…¼å‚™æœ‰å¾·èƒ½", "desc": "æ™ºè¬€å…¼å‚™ï¼Œå¾·é‡æ¦®é”ï¼Œå¨æœ›æˆå¸«ï¼Œæ´‹æ´‹å¤§è§€"},
        52: {"luck": "å¤§å‰", "meaning": "å…ˆè¦‹ä¹‹æ˜å¯¦ç¾å¿—", "desc": "çœ¼å…‰é å¤§ï¼Œç†æƒ³å¯¦ç¾ï¼Œæœ‰è¨ˆåŠƒåŠ›ï¼Œèƒ½æˆå¤§æ¥­"},
        # å‡¶æ•¸
        19: {"luck": "å‡¶", "meaning": "é¢¨é›²é®æ—¥è¾›è‹¦é‡", "desc": "é¢¨äº‘è”½æ—¥ï¼Œè¾›è‹¦é‡ä¾†ï¼Œé›–æœ‰æ™ºè¬€ï¼Œè¬äº‹æŒ«æŠ˜"},
        20: {"luck": "å‡¶", "meaning": "æ™ºé«˜å¿—å¤§é›£æœ›æˆ", "desc": "æ™ºé«˜å¿—å¤§ï¼Œæ­·ç›¡è‰±é›£ï¼Œæ†‚æ‚¶ç…©æƒ±ï¼Œé€²é€€å…©é›£"},
        22: {"luck": "å‡¶", "meaning": "ç§‹è‰é€¢éœœå‹è‹¦å¤š", "desc": "ç§‹è‰é€¢éœœï¼Œæ‡·æ‰ä¸é‡ï¼Œæ†‚æ„æ€¨è‹¦ï¼Œäº‹ä¸å¦‚æ„"},
        26: {"luck": "å‡¶", "meaning": "è®Šæ€ªå¥‡ç•°è±ªä¿ ç¾©", "desc": "è®Šæ€ªä¹‹è¬ï¼Œè‹±é›„è±ªå‚‘ï¼Œæ³¢ç€¾é‡ç–Šï¼Œè€Œå¥å¤§åŠŸ"},
        27: {"luck": "å‡¶", "meaning": "è‡ªæˆ‘å¿ƒå¼·èª¹è¬—ä¸­", "desc": "è‡ªæˆ‘å¿ƒéå¼·ï¼Œå¤šå—èª¹è¬—æ”»æ“Šï¼Œèª¹é›£äº¦èƒ½æˆåŠŸ"},
        28: {"luck": "å‡¶", "meaning": "è±ªå‚‘æ°£æ¦‚å››æµ·æ¼‚", "desc": "é­é›£é‹ï¼Œè±ªå‚‘æ°£æ¦‚ï¼Œå››æµ·é£„æ³Šï¼Œçµ‚ä¸–èºå‹•"},
        30: {"luck": "åŠå‰", "meaning": "æ²‰æµ®ä¸å®šæˆæ•—é–“", "desc": "ä¸€æˆä¸€æ•—ï¼Œçµ•è™•é€¢ç”Ÿï¼Œæœ‰æ™ºè¬€ï¼ŒæˆåŠŸå¯æœŸ"},
        34: {"luck": "å‡¶", "meaning": "ç½é›£ä¸çµ•è¾›è‹¦å¤š", "desc": "ç½é›£ä¸çµ•ï¼Œé›£æœ›æˆåŠŸï¼Œæ­¤æ•¸å¤§å‡¶ï¼Œä¸å¦‚æ›´å"},
        36: {"luck": "å‡¶", "meaning": "æ³¢ç€¾è¬ä¸ˆä¿ ç¾©è–„", "desc": "æ³¢ç€¾é‡ç–Šï¼Œå¸¸é™·çª®å›°ï¼Œå‹•ä¸å¦‚éœï¼Œæœ‰æ‰ç„¡å‘½"},
        38: {"luck": "åŠå‰", "meaning": "ç£¨éµæˆé‡æ„å¿—å¼·", "desc": "éç„¡å¤§å¿—ï¼Œå¯¦ä¹çµ±ç‡ï¼Œé›£æœ›æˆåŠŸï¼Œå®œè¬¹å®ˆç‚ºå®‰"},
        40: {"luck": "å‡¶", "meaning": "æ™ºè¬€è†½åŠ›å†’éšªæŠ•", "desc": "æ™ºè¬€è†½åŠ›ï¼Œå†’éšªæŠ•æ©Ÿï¼Œæ²‰æµ®ä¸å®šï¼Œé€€ä¿å¹³å®‰"},
        42: {"luck": "å‡¶", "meaning": "å¯’èŸ¬åœ¨æŸ³åè—ä¸", "desc": "åšè­˜å¤šèƒ½ï¼Œç²¾é€šä¸–æƒ…ï¼Œå¦‚èƒ½å°ˆå¿ƒï¼Œå¯æœ›æˆåŠŸ"},
        43: {"luck": "å‡¶", "meaning": "æ•£è²¡ç ´ç”¢å¤–ç¥¥å…§", "desc": "å¤–ç¥¥å…§è‹¦ï¼Œå¤–ç·£é›–å¥½ï¼Œå…§è£¡ç©ºè™›ï¼Œè²¡é›£èš"},
        44: {"luck": "å‡¶", "meaning": "é›£æˆå¤§æ¥­ç ´å®¶è²¡", "desc": "é›£æˆå¤§æ¥­ï¼Œå¤–è§€é›–å¥½ï¼Œå…§åœ¨ç©ºè™›ï¼Œéœ€æœ‰è€å¿ƒ"},
        46: {"luck": "å‡¶", "meaning": "è¼‰å¯¶æ²‰èˆŸè‹¦é›£å¤š", "desc": "è¼‰å¯¶æ²‰èˆŸï¼Œæµªè£¡æ·˜é‡‘ï¼Œå¤§é›£å˜—ç›¡ï¼Œçµ‚ç²æˆåŠŸ"},
        49: {"luck": "å‡¶", "meaning": "å‰å‡¶äº’è¦‹ä¸€æˆä¸€", "desc": "å‰å‡¶äº’è¦‹ï¼Œä¸€æˆä¸€æ•—ï¼Œå‡¶ä¸­æœ‰å‰ï¼Œå‰ä¸­æœ‰å‡¶"},
        50: {"luck": "å‡¶", "meaning": "å°èˆŸå…¥æµ·å‰å‡¶åƒ", "desc": "å°èˆŸå…¥æµ·ï¼Œå‰å‡¶åƒåŠï¼Œé ˆé˜²å‚¾è¦†ï¼Œå‡¶å¤šå‰å°‘"}
    }

    # ä¸‰æ‰é…ç½®å‰å‡¶ (å¤©æ ¼/äººæ ¼/åœ°æ ¼çš„äº”è¡Œçµ„åˆ)
    SANCAI_COMBINATIONS = {
        # å¤§å‰çµ„åˆ
        ("æœ¨", "æœ¨", "æœ¨"): {"luck": "å¤§å‰", "desc": "åŒå¿ƒåŒå¾·ï¼ŒæˆåŠŸé †åˆ©ï¼Œèƒ½å¹³å®‰å¯¦ç¾ç›®çš„"},
        ("æœ¨", "æœ¨", "ç«"): {"luck": "å¤§å‰", "desc": "æˆåŠŸé †èª¿ï¼Œå‘ä¸Šç™¼å±•ï¼ŒåŸºç¤å®‰æ³°"},
        ("æœ¨", "ç«", "æœ¨"): {"luck": "å¤§å‰", "desc": "æˆåŠŸé‹ä½³ï¼Œå¢ƒé‡å®‰å®šï¼Œé…ç½®å‰ç¥¥"},
        ("æœ¨", "ç«", "ç«"): {"luck": "å¤§å‰", "desc": "å—ä¸Šå¸ä¹‹æƒ æ¾¤ï¼Œå‘ä¸Šé †åˆ©ç™¼å±•"},
        ("æœ¨", "ç«", "åœŸ"): {"luck": "å¤§å‰", "desc": "å¾—é•·è¼©æˆ–ä¸Šå¸ä¹‹æƒ åŠ©ï¼ŒæˆåŠŸé †åˆ©ç™¼å±•"},
        ("ç«", "æœ¨", "æœ¨"): {"luck": "å¤§å‰", "desc": "æˆåŠŸé †åˆ©ï¼Œèƒ½å¹³å®‰é”åˆ°ç›®çš„"},
        ("ç«", "æœ¨", "ç«"): {"luck": "å¤§å‰", "desc": "æˆåŠŸé‹ä½³ï¼Œå‘ä¸Šç™¼å±•å®¹æ˜“é”åˆ°ç›®çš„"},
        ("ç«", "ç«", "æœ¨"): {"luck": "å¤§å‰", "desc": "ç››é‹æ˜Œéš†ï¼ŒæˆåŠŸç™¼å±•ï¼Œç›®çš„é”æˆ"},
        ("ç«", "ç«", "ç«"): {"luck": "å‰", "desc": "ç©æ¥µé€²å–ï¼ŒæˆåŠŸè¿…é€Ÿï¼Œä½†éœ€é˜²æ€¥èº"},
        ("ç«", "ç«", "åœŸ"): {"luck": "å¤§å‰", "desc": "å¾—ä¸Šå¸æƒ æ¾¤ï¼ŒæˆåŠŸé †åˆ©ç™¼å±•"},
        ("åœŸ", "ç«", "ç«"): {"luck": "å¤§å‰", "desc": "å¾—ç¥–è¼©æˆ–ä¸Šå¸ä¹‹æƒ åŠ©ï¼Œå¯æˆåŠŸç™¼å±•"},
        ("åœŸ", "ç«", "åœŸ"): {"luck": "å¤§å‰", "desc": "å¯å¾—æ„å¤–ä¹‹å¤§æˆåŠŸç™¼å±•"},
        ("åœŸ", "åœŸ", "ç«"): {"luck": "å¤§å‰", "desc": "å¢ƒé‡å®‰å›ºï¼Œèº«å¿ƒå¥åº·ï¼Œå¯æœ›é•·å£½"},
        ("åœŸ", "åœŸ", "åœŸ"): {"luck": "å¤§å‰", "desc": "æ€§æƒ…ç©©å›ºï¼ŒæˆåŠŸç·©æ…¢ä½†å¹³å®‰"},
        ("é‡‘", "åœŸ", "åœŸ"): {"luck": "å¤§å‰", "desc": "æ‰¿è’™ä¸Šå¸å¼•é€²ï¼ŒæˆåŠŸé †åˆ©ç™¼å±•"},
        ("é‡‘", "åœŸ", "é‡‘"): {"luck": "å¤§å‰", "desc": "å®¹æ˜“æˆåŠŸé”åˆ°ç›®çš„ï¼Œå¢ƒé‡å®‰å›º"},
        ("é‡‘", "é‡‘", "åœŸ"): {"luck": "å¤§å‰", "desc": "æˆåŠŸé‹ä½³ï¼Œå¯é”ç›®çš„ï¼Œå¢ƒé‡å®‰æ³°"},
        ("é‡‘", "é‡‘", "é‡‘"): {"luck": "å‰", "meaning": "æˆåŠŸé †åˆ©ï¼Œä½†éœ€é˜²éå‰›"},
        ("æ°´", "é‡‘", "é‡‘"): {"luck": "å¤§å‰", "desc": "æˆåŠŸé †åˆ©ï¼Œèƒ½å¹³å®‰å¯¦ç¾ç›®çš„"},
        ("æ°´", "é‡‘", "æ°´"): {"luck": "å¤§å‰", "desc": "å¾—é•·è¼©æˆ–ä¸Šå¸ä¹‹æƒ åŠ©ï¼ŒæˆåŠŸç™¼å±•"},
        ("æ°´", "æ°´", "é‡‘"): {"luck": "å¤§å‰", "desc": "æ‰¿çˆ¶ç¥–ä¹‹è”­ï¼ŒæˆåŠŸé‹ä½³"},
        ("æ°´", "æ°´", "æ°´"): {"luck": "å‰", "desc": "æˆåŠŸé‹ä½³ï¼Œä½†éœ€é˜²éæ–¼æµå‹•"},
        # å‡¶çµ„åˆ
        ("æœ¨", "åœŸ", "ç«"): {"luck": "å‡¶", "desc": "æˆåŠŸé‹è¢«å£“æŠ‘ï¼Œä¸èƒ½ä¼¸å¼µ"},
        ("æœ¨", "åœŸ", "åœŸ"): {"luck": "å‡¶", "desc": "æˆåŠŸé‹è¢«å£“æŠ‘ï¼Œä¸èƒ½æœ‰æ‰€ä¼¸å¼µ"},
        ("æœ¨", "é‡‘", "æœ¨"): {"luck": "å‡¶", "desc": "é›–å¯ç²å¾—ç™¼å±•ï¼Œä½†åŸºç¤ä¸ç©©"},
        ("æœ¨", "é‡‘", "é‡‘"): {"luck": "å‡¶", "desc": "æˆåŠŸé‹è¢«å£“æŠ‘ï¼Œä¸èƒ½æˆåŠŸ"},
        ("ç«", "æ°´", "æœ¨"): {"luck": "å‡¶", "desc": "æ°´ç«ç›¸å…‹ï¼Œé…ç½®ä¸è‰¯"},
        ("ç«", "æ°´", "ç«"): {"luck": "å¤§å‡¶", "desc": "æ°´ç«ç›¸å…‹ï¼Œæ˜“é­ç½é›£"},
        ("ç«", "æ°´", "æ°´"): {"luck": "å¤§å‡¶", "desc": "æ°´ç«ä¸å®¹ï¼Œå‡¶éšªè¬åˆ†"},
        ("ç«", "é‡‘", "æœ¨"): {"luck": "å‡¶", "desc": "é›–æœ‰æˆåŠŸé‹ï¼Œä½†åŸºç¤ä¸ç©©"},
        ("åœŸ", "æœ¨", "æœ¨"): {"luck": "å‡¶", "desc": "æˆåŠŸé‹è¢«å£“æŠ‘ï¼Œä¸èƒ½æœ‰æ‰€ä¼¸å¼µ"},
        ("åœŸ", "æœ¨", "ç«"): {"luck": "å‡¶", "desc": "é›–å¯æˆåŠŸï¼Œä½†å¸¸å—å›°æ“¾"},
        ("åœŸ", "æ°´", "ç«"): {"luck": "å‡¶", "desc": "å¢ƒé‡ä¸å®‰ï¼Œè®Šå‹•é »ç¹"},
        ("åœŸ", "æ°´", "æ°´"): {"luck": "å‡¶", "desc": "æˆåŠŸé‹è¢«å£“æŠ‘ï¼Œä¸èƒ½æœ‰æ‰€ä¼¸å¼µ"},
        ("é‡‘", "ç«", "æœ¨"): {"luck": "å‡¶", "desc": "ç«å…‹é‡‘ï¼Œæ˜“ç”Ÿç½ç¦"},
        ("é‡‘", "ç«", "ç«"): {"luck": "å¤§å‡¶", "desc": "ç«å…‹é‡‘ï¼Œå‡¶éšªè¬åˆ†"},
        ("é‡‘", "æœ¨", "æœ¨"): {"luck": "å‡¶", "desc": "é›–å¯æˆåŠŸï¼Œä½†å¸¸å—æŒ«æŠ˜"},
        ("é‡‘", "æœ¨", "ç«"): {"luck": "å‡¶", "desc": "é›–å¯æˆåŠŸç™¼å±•ï¼Œä½†æ˜“ç”Ÿç½è®Š"},
        ("æ°´", "åœŸ", "ç«"): {"luck": "å‡¶", "desc": "åœŸå…‹æ°´ï¼ŒæˆåŠŸé‹è¢«å£“æŠ‘"},
        ("æ°´", "åœŸ", "åœŸ"): {"luck": "å¤§å‡¶", "desc": "åœŸå…‹æ°´ï¼Œé›£ä»¥æˆåŠŸ"},
        ("æ°´", "ç«", "æœ¨"): {"luck": "å‡¶", "desc": "æ°´ç«ä¸å®¹ï¼Œæ˜“ç”Ÿç½ç¦"},
        ("æ°´", "ç«", "ç«"): {"luck": "å¤§å‡¶", "desc": "æ°´ç«ç›¸å…‹ï¼Œå‡¶éšªè¬åˆ†"}
    }

    def __init__(self, name: str, gender: str = "ç”·"):
        """
        åˆå§‹åŒ–å§“ååˆ†æè¨ˆç®—å™¨

        Args:
            name: å§“åï¼ˆç¹é«”æˆ–ç°¡é«”ä¸­æ–‡ï¼‰
            gender: æ€§åˆ¥ï¼ˆ"ç”·" æˆ– "å¥³"ï¼‰
        """
        self.name = name
        self.gender = gender
        self.name_chars = list(name)

    def get_stroke_count(self, char: str) -> int:
        """
        ç²å–å–®å€‹æ¼¢å­—çš„ç­†ç•«æ•¸ï¼ˆå§“åå­¸å°ˆç”¨ç­†ç•«ï¼‰
        é€™è£¡ä½¿ç”¨ç°¡åŒ–ç‰ˆæœ¬ï¼Œå¯¦éš›æ‡‰ç”¨ä¸­éœ€è¦å®Œæ•´çš„å§“åå­¸ç­†ç•«å­—å…¸
        """
        # å¸¸ç”¨å§“æ°ç­†ç•«ï¼ˆéƒ¨åˆ†ç¤ºä¾‹ï¼‰
        common_surnames_strokes = {
            # å–®å§“
            "ç‹": 4, "æ": 7, "å¼µ": 11, "åŠ‰": 15, "é™³": 16, "æ¥Š": 13, "é»ƒ": 12, "è¶™": 14,
            "å‘¨": 8, "å³": 7, "å¾": 10, "å­«": 10, "é¦¬": 10, "æœ±": 6, "èƒ¡": 11, "éƒ­": 15,
            "ä½•": 7, "é«˜": 10, "æ—": 8, "ç¾…": 20, "é„­": 19, "æ¢": 11, "è¬": 17, "å®‹": 7,
            "å”": 10, "è¨±": 11, "éŸ“": 17, "é¦®": 12, "é„§": 19, "æ›¹": 11, "å½­": 12, "æ›¾": 12,
            "è•­": 19, "è”¡": 17, "æ½˜": 16, "ç”°": 5, "è‘£": 15, "è¢": 10, "æ–¼": 8, "ä½™": 7,
            "è‘‰": 15, "è”£": 17, "æœ": 7, "è˜‡": 22, "é­": 18, "ç¨‹": 12, "å‘‚": 7, "ä¸": 2,
            "æ²ˆ": 8, "ä»»": 6, "å§š": 9, "ç›§": 16, "å‚…": 12, "é¾": 17, "æ±ª": 8, "æˆ´": 18,
            "å´”": 11, "å»–": 15, "è³ˆ": 13, "æ–¹": 4, "çŸ³": 5, "å§œ": 9, "é‚±": 12, "ä¾¯": 9,
            # è¤‡å§“
            "å¸é¦¬": 15, "æ­é™½": 23, "ä¸Šå®˜": 11, "è«¸è‘›": 23, "æ±æ–¹": 12, "æ…•å®¹": 24,
            # åå­—å¸¸ç”¨å­—
            "å‰": 11, "è¯": 14, "æ˜": 8, "å¼·": 12, "è»": 9, "å»º": 9, "åœ‹": 11, "æ–‡": 4,
            "å¿—": 7, "å‹‡": 9, "å‚‘": 12, "éµ¬": 19, "é¾": 16, "æµ·": 11, "æ³¢": 9, "æ¿¤": 18,
            "å®‡": 6, "æµ©": 11, "å®": 7, "åš": 12, "å‡±": 12, "é›·": 13, "ç£Š": 15, "å³°": 10,
            "è¶…": 12, "æ–Œ": 11, "è¼": 15, "å‰›": 10, "å¹³": 5, "é£›": 9, "äº®": 9, "æ±": 8,
            "é›ª": 11, "æ¢…": 11, "éº—": 19, "èŠ³": 10, "ç‰": 5, "è˜­": 23, "ç´…": 9, "ç§€": 7,
            "å©·": 12, "å¨Ÿ": 10, "éœ": 16, "ç‘©": 15, "æ•": 11, "å¬Œ": 15, "ç³": 13, "ç©": 16,
            "éœ": 17, "ç‡•": 16, "æ™¶": 12, "å¦": 7, "è": 14, "è‰": 13, "æ…§": 15, "è‰·": 24,
            "æ¬£": 8, "æ€¡": 9, "ä½³": 8, "çª": 13, "é›…": 12, "å©·": 12, "è–‡": 19, "ç‘¤": 15,
            "å­": 3, "ä¸€": 1, "ä¹‹": 4, "å¤©": 4, "å¿ƒ": 4, "æˆ": 7, "å®‰": 6, "ä»": 4,
            "ç¾©": 13, "ç¦®": 18, "æ™º": 12, "ä¿¡": 9, "å¾·": 15, "ç¦": 14, "ç¥¿": 13, "å£½": 14,
            "å–œ": 12, "æ¨‚": 15, "å’Œ": 8, "å¹³": 5, "å‰": 6, "ç¥¥": 11, "é †": 12, "é”": 16
        }

        # å¦‚æœåœ¨å­—å…¸ä¸­ï¼Œè¿”å›å°æ‡‰ç­†ç•«
        if char in common_surnames_strokes:
            return common_surnames_strokes[char]

        # å¦å‰‡ä½¿ç”¨ç°¡åŒ–ä¼°ç®—ï¼ˆå¯¦éš›æ‡‰ç”¨éœ€å®Œæ•´å­—å…¸ï¼‰
        # é€™è£¡ä½¿ç”¨ Unicode ç¢¼ä½çš„ç°¡åŒ–ä¼°ç®—
        code = ord(char)
        if 0x4E00 <= code <= 0x9FFF:  # CJKçµ±ä¸€æ¼¢å­—
            # ç°¡åŒ–ä¼°ç®—ï¼šæ ¹æ“šéƒ¨é¦–è¤‡é›œåº¦
            return max(1, min(30, (code - 0x4E00) % 30 + 1))
        return 1

    def calculate_five_grids(self) -> Dict[str, Any]:
        """
        è¨ˆç®—äº”æ ¼ï¼šå¤©æ ¼ã€äººæ ¼ã€åœ°æ ¼ã€å¤–æ ¼ã€ç¸½æ ¼

        Returns:
            äº”æ ¼é…ç½®å­—å…¸
        """
        # ç²å–å§“åå„å­—ç­†ç•«
        strokes = [self.get_stroke_count(char) for char in self.name_chars]

        # æ ¹æ“šå§“åé•·åº¦è¨ˆç®—äº”æ ¼
        if len(self.name_chars) == 2:  # å–®å§“å–®å
            surname_stroke = strokes[0]
            name_stroke = strokes[1]

            tian_ge = surname_stroke + 1  # å¤©æ ¼
            ren_ge = surname_stroke + name_stroke  # äººæ ¼
            di_ge = name_stroke + 1  # åœ°æ ¼
            wai_ge = 2  # å¤–æ ¼
            zong_ge = surname_stroke + name_stroke  # ç¸½æ ¼

        elif len(self.name_chars) == 3:  # å–®å§“é›™å
            surname_stroke = strokes[0]
            name1_stroke = strokes[1]
            name2_stroke = strokes[2]

            tian_ge = surname_stroke + 1  # å¤©æ ¼
            ren_ge = surname_stroke + name1_stroke  # äººæ ¼
            di_ge = name1_stroke + name2_stroke  # åœ°æ ¼
            wai_ge = name2_stroke + 1  # å¤–æ ¼
            zong_ge = surname_stroke + name1_stroke + name2_stroke  # ç¸½æ ¼

        elif len(self.name_chars) == 4:  # è¤‡å§“æˆ–è¤‡å§“é›™å
            # å‡è¨­å‰å…©å­—ç‚ºå§“
            surname1_stroke = strokes[0]
            surname2_stroke = strokes[1]
            name1_stroke = strokes[2] if len(strokes) > 2 else 1
            name2_stroke = strokes[3] if len(strokes) > 3 else 1

            tian_ge = surname1_stroke + surname2_stroke  # å¤©æ ¼
            ren_ge = surname2_stroke + name1_stroke  # äººæ ¼
            di_ge = name1_stroke + name2_stroke  # åœ°æ ¼
            wai_ge = surname1_stroke + name2_stroke  # å¤–æ ¼
            zong_ge = sum(strokes)  # ç¸½æ ¼
        else:
            # å…¶ä»–æƒ…æ³çš„ç°¡åŒ–è™•ç†
            tian_ge = strokes[0] + 1
            ren_ge = sum(strokes[:2]) if len(strokes) >= 2 else strokes[0] + 1
            di_ge = sum(strokes[1:]) + 1 if len(strokes) > 1 else strokes[0] + 1
            wai_ge = 2
            zong_ge = sum(strokes)

        # ç¢ºä¿æ•¸å€¼åœ¨1-81ç¯„åœå…§
        tian_ge = ((tian_ge - 1) % 81) + 1
        ren_ge = ((ren_ge - 1) % 81) + 1
        di_ge = ((di_ge - 1) % 81) + 1
        wai_ge = ((wai_ge - 1) % 81) + 1
        zong_ge = ((zong_ge - 1) % 81) + 1

        return {
            "tian_ge": {
                "value": tian_ge,
                "meaning": self.get_shuli_meaning(tian_ge),
                "wuxing": self.get_wuxing(tian_ge)
            },
            "ren_ge": {
                "value": ren_ge,
                "meaning": self.get_shuli_meaning(ren_ge),
                "wuxing": self.get_wuxing(ren_ge)
            },
            "di_ge": {
                "value": di_ge,
                "meaning": self.get_shuli_meaning(di_ge),
                "wuxing": self.get_wuxing(di_ge)
            },
            "wai_ge": {
                "value": wai_ge,
                "meaning": self.get_shuli_meaning(wai_ge),
                "wuxing": self.get_wuxing(wai_ge)
            },
            "zong_ge": {
                "value": zong_ge,
                "meaning": self.get_shuli_meaning(zong_ge),
                "wuxing": self.get_wuxing(zong_ge)
            },
            "strokes": strokes
        }

    def get_wuxing(self, number: int) -> str:
        """
        æ ¹æ“šæ•¸å­—å°¾æ•¸ç²å–äº”è¡Œå±¬æ€§
        1-2: æœ¨, 3-4: ç«, 5-6: åœŸ, 7-8: é‡‘, 9-0: æ°´
        """
        last_digit = number % 10
        if last_digit in [1, 2]:
            return "æœ¨"
        elif last_digit in [3, 4]:
            return "ç«"
        elif last_digit in [5, 6]:
            return "åœŸ"
        elif last_digit in [7, 8]:
            return "é‡‘"
        else:  # 9, 0
            return "æ°´"

    def get_shuli_meaning(self, number: int) -> Dict[str, str]:
        """ç²å–æ•¸ç†å‰å‡¶å«ç¾©"""
        if number in self.SHULI_MEANINGS:
            return self.SHULI_MEANINGS[number]
        else:
            # å°æ–¼æœªå®šç¾©çš„æ•¸å­—ï¼Œè¿”å›ä¸­æ€§è©•åƒ¹
            return {
                "luck": "å¹³",
                "meaning": "å¹³å¸¸ä¹‹æ•¸",
                "desc": "æ­¤æ•¸ç†å«ç¾©å°šéœ€é€²ä¸€æ­¥ç ”ç©¶"
            }

    def analyze_sancai(self, five_grids: Dict) -> Dict[str, Any]:
        """
        åˆ†æä¸‰æ‰é…ç½®ï¼ˆå¤©æ ¼ã€äººæ ¼ã€åœ°æ ¼çš„äº”è¡Œçµ„åˆï¼‰
        """
        tian_wuxing = five_grids["tian_ge"]["wuxing"]
        ren_wuxing = five_grids["ren_ge"]["wuxing"]
        di_wuxing = five_grids["di_ge"]["wuxing"]

        combination = (tian_wuxing, ren_wuxing, di_wuxing)

        # æŸ¥æ‰¾ä¸‰æ‰é…ç½®
        if combination in self.SANCAI_COMBINATIONS:
            sancai_result = self.SANCAI_COMBINATIONS[combination]
        else:
            # åˆ†æäº”è¡Œç”Ÿå‰‹é—œä¿‚
            sancai_result = self.analyze_wuxing_relation(tian_wuxing, ren_wuxing, di_wuxing)

        return {
            "combination": f"{tian_wuxing}{ren_wuxing}{di_wuxing}",
            "tian_ge_wuxing": tian_wuxing,
            "ren_ge_wuxing": ren_wuxing,
            "di_ge_wuxing": di_wuxing,
            "luck": sancai_result.get("luck", "å¹³"),
            "description": sancai_result.get("desc", "ä¸‰æ‰é…ç½®éœ€é€²ä¸€æ­¥åˆ†æ")
        }

    def analyze_wuxing_relation(self, tian: str, ren: str, di: str) -> Dict[str, str]:
        """
        åˆ†æä¸‰æ‰äº”è¡Œç”Ÿå‰‹é—œä¿‚
        """
        # äº”è¡Œç›¸ç”Ÿï¼šæœ¨â†’ç«â†’åœŸâ†’é‡‘â†’æ°´â†’æœ¨
        # äº”è¡Œç›¸å‰‹ï¼šæœ¨å‰‹åœŸã€åœŸå‰‹æ°´ã€æ°´å‰‹ç«ã€ç«å‰‹é‡‘ã€é‡‘å‰‹æœ¨
        sheng = {
            "æœ¨": "ç«", "ç«": "åœŸ", "åœŸ": "é‡‘", "é‡‘": "æ°´", "æ°´": "æœ¨"
        }
        ke = {
            "æœ¨": "åœŸ", "åœŸ": "æ°´", "æ°´": "ç«", "ç«": "é‡‘", "é‡‘": "æœ¨"
        }

        # æª¢æŸ¥å¤©æ ¼â†’äººæ ¼é—œä¿‚
        if sheng.get(tian) == ren:
            tian_ren = "ç›¸ç”Ÿï¼ˆå‰ï¼‰"
        elif ke.get(tian) == ren:
            tian_ren = "ç›¸å‰‹ï¼ˆå‡¶ï¼‰"
        elif tian == ren:
            tian_ren = "æ¯”å’Œï¼ˆå¹³ï¼‰"
        else:
            tian_ren = "ç„¡ç‰¹æ®Šé—œä¿‚"

        # æª¢æŸ¥äººæ ¼â†’åœ°æ ¼é—œä¿‚
        if sheng.get(ren) == di:
            ren_di = "ç›¸ç”Ÿï¼ˆå‰ï¼‰"
        elif ke.get(ren) == di:
            ren_di = "ç›¸å‰‹ï¼ˆå‡¶ï¼‰"
        elif ren == di:
            ren_di = "æ¯”å’Œï¼ˆå¹³ï¼‰"
        else:
            ren_di = "ç„¡ç‰¹æ®Šé—œä¿‚"

        # ç¶œåˆåˆ¤æ–·
        if "ç›¸ç”Ÿ" in tian_ren and "ç›¸ç”Ÿ" in ren_di:
            luck = "å‰"
            desc = "ä¸‰æ‰é…ç½®ï¼Œå¤©æ ¼ç”Ÿäººæ ¼ï¼Œäººæ ¼ç”Ÿåœ°æ ¼ï¼Œå¤§å‰ä¹‹è±¡"
        elif "ç›¸å‰‹" in tian_ren or "ç›¸å‰‹" in ren_di:
            luck = "å‡¶"
            desc = "ä¸‰æ‰é…ç½®æœ‰ç›¸å‰‹ä¹‹è±¡ï¼Œéœ€æ³¨æ„èª¿å’Œ"
        else:
            luck = "å¹³"
            desc = "ä¸‰æ‰é…ç½®å¹³ç©©ï¼Œç„¡ç‰¹åˆ¥å‰å‡¶"

        return {
            "luck": luck,
            "desc": desc,
            "tian_ren_relation": tian_ren,
            "ren_di_relation": ren_di
        }

    def analyze(self) -> Dict[str, Any]:
        """
        åŸ·è¡Œå®Œæ•´çš„å§“åå­¸åˆ†æ

        Returns:
            å®Œæ•´çš„å§“åå­¸åˆ†æçµæœ
        """
        # è¨ˆç®—äº”æ ¼
        five_grids = self.calculate_five_grids()

        # åˆ†æä¸‰æ‰
        sancai = self.analyze_sancai(five_grids)

        # ç¶œåˆè©•åˆ†ï¼ˆç°¡åŒ–ç‰ˆï¼‰
        scores = []
        for grid_name in ["tian_ge", "ren_ge", "di_ge", "wai_ge", "zong_ge"]:
            luck = five_grids[grid_name]["meaning"]["luck"]
            if "å¤§å‰" in luck:
                scores.append(10)
            elif "å‰" in luck:
                scores.append(7)
            elif "å¹³" in luck or "åŠ" in luck:
                scores.append(5)
            else:
                scores.append(3)

        overall_score = sum(scores) / len(scores)

        # åˆ¤æ–·æ•´é«”å‰å‡¶
        if overall_score >= 8:
            overall_luck = "å¤§å‰"
        elif overall_score >= 6:
            overall_luck = "å‰"
        elif overall_score >= 4:
            overall_luck = "å¹³"
        else:
            overall_luck = "å‡¶"

        return {
            "name": self.name,
            "gender": self.gender,
            "name_characters": self.name_chars,
            "five_grids": five_grids,
            "sancai": sancai,
            "overall_score": round(overall_score, 2),
            "overall_luck": overall_luck,
            "analysis_summary": {
                "tian_ge_summary": f"å¤©æ ¼{five_grids['tian_ge']['value']}ï¼ˆ{five_grids['tian_ge']['wuxing']}ï¼‰- {five_grids['tian_ge']['meaning']['luck']}",
                "ren_ge_summary": f"äººæ ¼{five_grids['ren_ge']['value']}ï¼ˆ{five_grids['ren_ge']['wuxing']}ï¼‰- {five_grids['ren_ge']['meaning']['luck']}",
                "di_ge_summary": f"åœ°æ ¼{five_grids['di_ge']['value']}ï¼ˆ{five_grids['di_ge']['wuxing']}ï¼‰- {five_grids['di_ge']['meaning']['luck']}",
                "wai_ge_summary": f"å¤–æ ¼{five_grids['wai_ge']['value']}ï¼ˆ{five_grids['wai_ge']['wuxing']}ï¼‰- {five_grids['wai_ge']['meaning']['luck']}",
                "zong_ge_summary": f"ç¸½æ ¼{five_grids['zong_ge']['value']}ï¼ˆ{five_grids['zong_ge']['wuxing']}ï¼‰- {five_grids['zong_ge']['meaning']['luck']}",
                "sancai_summary": f"ä¸‰æ‰é…ç½®ï¼š{sancai['combination']} - {sancai['luck']}"
            }
        }


def test_name_analysis():
    """æ¸¬è©¦å‡½æ•¸"""
    # æ¸¬è©¦ç¯„ä¾‹
    test_names = [
        ("ç‹å°æ˜", "ç”·"),
        ("æç¾éº—", "å¥³"),
        ("å¼µå‰è¯", "ç”·")
    ]

    for name, gender in test_names:
        print(f"\n{'='*80}")
        print(f"æ¸¬è©¦å§“åï¼š{name}ï¼ˆ{gender}ï¼‰")
        print('='*80)

        calculator = NameAnalysisCalculator(name, gender)
        result = calculator.analyze()

        print(f"\nğŸ“Š äº”æ ¼é…ç½®ï¼š")
        print(f"   {result['analysis_summary']['tian_ge_summary']}")
        print(f"   {result['analysis_summary']['ren_ge_summary']}")
        print(f"   {result['analysis_summary']['di_ge_summary']}")
        print(f"   {result['analysis_summary']['wai_ge_summary']}")
        print(f"   {result['analysis_summary']['zong_ge_summary']}")

        print(f"\nğŸ”® ä¸‰æ‰é…ç½®ï¼š")
        print(f"   {result['analysis_summary']['sancai_summary']}")
        print(f"   {result['sancai']['description']}")

        print(f"\nâœ¨ ç¶œåˆè©•åƒ¹ï¼š")
        print(f"   è©•åˆ†ï¼š{result['overall_score']}/10")
        print(f"   å‰å‡¶ï¼š{result['overall_luck']}")


if __name__ == "__main__":
    test_name_analysis()
